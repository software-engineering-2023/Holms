<!DOCTYPE html>
<html lang="en">

<head>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
  <link rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&amp;display=swap"
      data-tag="font" />
      <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
      rel="stylesheet"
    />
  <link rel="stylesheet" href="../Styling/styles.css">
  <style>
  
   
    #transfer {
        width: 100%;
       
      }
      #sidebar{
    min-height: 100vh;
    height: auto;
    padding-left: 10px;
  }
  #content {
    
    min-height: 100vh;
    /* height: auto; */
    display: flex;
    justify-content: center;
    margin-right: 85px;
    margin-bottom: 2%;
  }
  #f{
    width: 75%;
    height: max-content;
  }
  footer {
    flex-shrink: 0;
    background-color: #223656;
  }
  #footerRow {
    display: flex;
    margin-left: 20px;
    /* gap: -60px; */
    /* font-size: 12px; */
    padding-top: 10px;
    justify-content: space-around;
  }
  #errorMessage{
    color: rgba(145, 5, 5, 0.695);
    display: none;
    font-weight: bold;
}
input{
  margin-bottom: 2%;
}
.toast-header{
  color:#ffff;
  background-color: #fa824c;
}
.toast{
  color:#ffff;
  background-color: #fa824c;
}
.btn-close{
  margin-left: 200%;
  
}
select{
  width: 89%;
  margin-bottom: 2%;
}
  </style>
  <title>Apply for Loan</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
 
  
</head>

<body>
  <div class="topNav" id="myTopnav">
    <div class="Logo">
      <img
        id="hammenu"
        src="../assets/hammenu.png"
        alt="Hamburger Menu Icon Png @clipartmax.com"
        onclick="toggleSidebar()"
      />
      <a href="../DashBoards/ClientDash.html">
        <img src="../Assets/logoFinal.png" alt="Logo!"
      /></a>
    </div>
    <div class="options">
      <!-- <a href="../Login_Reg/Login.html"><img id="back" src="../Assets/left-chevron.png" alt="back"></a> -->

      <a href="../DashBoards/ClientDash.html" >Home</a>
      <a href="../DashBoards/currency.html">Currency Exchange</a>
      <a href="../DashBoards/FAQ.html">FAQs</a>
      <a href="../DashBoards/ContactUs.html">Contact Us</a>

      <!-- <a href="../DashBoards/homePage.html">Logout</a> -->

      <div class="notification-dropdown" onclick="toggleNotificationList()">
        <img
          src="../assets/bell.png"
          alt="Notification Bell"
          class="notification-bell"
        />
        <ul id="notificationList" class="notification-list">
          <li class="notification-list-item">Welcome to HOLMS!</li>
          <li class="notification-list-item">Payment due in 10 days</li>
          <li class="notification-list-item">Salary has been received!</li>
        </ul>
      </div>

      <a href="../editProfile.html"
        ><img src="../Assets/profile.png" id="profileImage" alt="profile!"
      /></a>
    </div>
  </div>


<div class="container">
  <div class="row">
    <div class="col-12">
        
        <div class="toast danger" id="EpicToast" role="alert" aria-live="assertive" aria-atomic="true" style="position: absolute; top: 20px; right: 20px;">
            <div class="toast-header">
                <strong class="mr-auto">Success!</strong>
                
                
                
                <small></small>
  <!-- <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button> -->
            </div>
            
            <div class="toast-body">
                Application Successful
            </div>
        </div>
    </div>
</div>
</div>
<div class="row" >
  <div id="sidebar">
    <ul>
      <li>
        <a href="../DashBoards/ClientDash.html">
          <img
            src="../assets/house.png"
            style="height: auto; width: 25px; padding-right: 3%"
          />
          Home
        </a>
      </li>
      <li>
        <a href="../Views/ViewAccounts.html">
          <img
            src="../assets/accounting.png"
            style="height: auto; width: 25px; padding-right: 3%"
          />
          Accounts</a
        >
      </li>
      <li>
        <a href="../Transfers/Transfers.html"
          ><img
            src="../assets/transfer.png"
            style="height: auto; width: 25px; padding-right: 3%"
          />
          Transfers</a
        >
      </li>
      <li>
        <a href="#" onclick="toggleSublist('payments')"
          ><img
            src="../assets/payment-method.png"
            style="height: auto; width: 25px; padding-right: 3%"
          />
          Payments</a
        >
        <ul id="paymentsSublist" class="sublist">
          <li><a href="../Transfers/Transfers.html"> Transfer</a></li>
          <li><a href="../Payments/Donations.html"> Donations</a></li>
          <li>
            <a href="../Payments/CreditcardPayment.html">
              Credit Card Payment</a
            >
          </li>
          <li><a href="../Payments/LoanPayment.html"> Loan Payment</a></li>
          <li><a href="../Payments/BillPayment.html"> Bill Payment</a></li>
        </ul>
      </li>
      <li>
        <a href="../DashBoards/Settings.html"
          ><img
            src="../assets/settings.png"
            style="height: auto; width: 25px; padding-right: 3%"
          />
          Settings</a
        >
      </li>
      <li id="logoutButton">
        <a href="../DashBoards/homePage.html"
          ><img
            src="../assets/logout2.png"
            style="height: auto; width: 30px; padding-right: 8%"
          />Logout</a
        >
      </li>
    </ul>
  </div>
  <div class="col">
    <div id="logo" class="text-center">
      <h2>APPLY FOR A LOAN</h2>
     </div>
    <div id="content">
    <form id="f">
      
      <label for="firstName">First Name:</label>
      <input type="text" id="firstName" name="firstName" required>
      <label for="lastName">Last Name:</label>
      <input type="text" id="lastName" name="lastName" required>
      <label for="email">Email:</label>
      <input type="text" id="email" name="email" required>
      <label for="phoneNumber">Phone Number:</label>
      <input type="text" id="phoneNumber" name="phoneNumber" required>
      <label for="age">Age:</label>
      <input type="number" id="age" name="age" min="10" max="100" required>

      <label for="monthlyIncome">Monthly Income:</label>
      <input type="number" id="monthlyIncome" name="monthlyIncome" step="0.01" required>

      <label for="employmentStatus">Employment Status:</label>
      <select id="employmentStatus" name="employmentStatus" required>
        <option value="">Select</option>
        <option value="worker">Worker</option>
        <option value="unemployed">Unemployed</option>
        <option value="selfEmployed">Self Employed</option>
      </select>

      <label for="type">Type of Loan:</label>
      <select id="type" name="type" required>
        <option value="">Select</option>
        <option value="personal">Personal</option>
        <option value="car">Car</option>
      </select>
      <label for="term">Loan Term:</label>
      <select id="term" name="term" required>
        <option value="">Select</option>
        <option value="12">1 year</option>
        <option value="24">2 years</option>
        <option value="36">3 years</option>
      </select>

      <label for="desiredLoanAmount">Desired Loan Amount (Up to 2500000):</label>
      <input type="number" id="desiredLoanAmount" name="desiredLoanAmount" step="0.01" required>
      <div id="errorMessage">
        Please fill in all required fields.
        <br/>
        <br/>
      </div>
      <input type="button" value="Apply" onclick="applyForm()">
    </form>
  </div>
  </div>
  </div>
  <footer>
    <div class="row" id="footerRow">
        <div class="col">
        <label  id="ii"><strong>Phone:</strong></label>
        <label id="ii">123-456-789</label>
    </div>
    <div class="col">
        <label  id="ii"><strong>Email:</strong></label>
        <label id="ii">sherlock@HOLMS.com</label>
    </div>
 <div class="col">
      <label  id="ii"><strong>Hotline:</strong></label>
      <label id="ii">987-654-321</label>
    </div>
    <div class="col">
      <label id="ii"><strong>Branch Address:</strong></label>
      
      <label  id="ii">221B Baker Street, London, United Kingdom</label></div>
    </div>
    </div>
</footer>
  <script>
    async function applyForm() {
      var firstName = document.getElementById("firstName").value;
      var lastName = document.getElementById("lastName").value;
      var email = document.getElementById("email").value;
      var phoneNumber = document.getElementById("phoneNumber").value;
      var age = document.getElementById("age").value;
      var monthlyIncome = parseFloat(document.getElementById("monthlyIncome").value);
      var employmentStatus = document.getElementById("employmentStatus").value;
      var type = document.getElementById("type").value;
      var term = parseInt(document.getElementById("term").value);
      var desiredLoanAmount = parseFloat(document.getElementById("desiredLoanAmount").value);

      var errorMessage = document.getElementById("errorMessage");

      var option = 
          {
              animation : true,
              delay : 2000
          };
          
      if (firstName === "") {
        errorMessage.style.display="block"
        errorMessage.innerText= "Please enter your First Name"
        return;
      }
      if (lastName === "") {
        errorMessage.style.display="block"
        errorMessage.innerText= "Please enter your Last Name"
        return;
      }
      if (email === "") {
        errorMessage.style.display="block"
        errorMessage.innerText= "Please enter your email"
        return;
      }
      if (age === "") {
        errorMessage.style.display="block"
        errorMessage.innerText= "Please enter your age"
        return;
      }

      if (isNaN(monthlyIncome) || monthlyIncome <= 0) {
        errorMessage.style.display="block"
        errorMessage.innerText="Please enter a valid monthly income.";
        return;
      }

      if (employmentStatus === "") {
        errorMessage.style.display="block"
        errorMessage.innerText="Please select your employment status.";
        return;
      }

      if (type === "") {
        errorMessage.style.display="block"
        errorMessage.innerText="Please select the type of loan.";
        return;
      }
      if (term === "") {
        errorMessage.style.display="block"
        errorMessage.innerText="Please select the term of loan.";
        return;
      }

      if (isNaN(desiredLoanAmount) || desiredLoanAmount <= 0 || desiredLoanAmount >= 2500000) {
        errorMessage.style.display="block"
        errorMessage.innerText="Loans must be within 0-2500000";
        return;
      }
      
  // ... (gather other data)

  // Prepare data for API call
  const applicationData = {
       firstName: firstName,
       lastName:lastName ,
       email: email ,
       phoneNumber: phoneNumber ,
       age:age ,
       income:monthlyIncome ,
       employmentInfo:employmentStatus ,
       loanPurpose:type ,
       loanTerm:term ,
       loanAmount:desiredLoanAmount,
       account:"662a925e96a434d09a75c77e" //change to be dynamic
       
  };

  // Send data to backend using fetch API (or similar)
  fetch("http://localhost:3000/clients/6622a499efdf7b38d6fd30ee/loanApp", {//change to be dynamic
    method: "POST",
    body: JSON.stringify(applicationData),
    headers: { "Content-Type": "application/json" }
  })
  .then(response => {
    if (response.ok) {
      var toastHTMLElement = document.getElementById( 'EpicToast' );
          
          var toastElement = new bootstrap.Toast( toastHTMLElement, option );
          
          toastElement.show( );
          toastHTMLElement.scrollIntoView({ behavior: "smooth" });
          errorMessage.style.display='none';
          setTimeout(function() {
                    // Redirect to the desired page
                    window.location.href = "../DashBoards/ClientDash.html";
                }, 1500);
     } 
    else {
      // Handle errors (e.g., display an error message)
    }
  });
}

      
      
    
  </script>
  <script>
    function toggleNotificationList() {
        var notificationList = document.getElementById("notificationList");
        notificationList.style.display = notificationList.style.display === "none" ? "block" : "none";
    }
    function toggleSidebar() {
        var sidebar = document.getElementById("sidebar");
        sidebar.style.display = sidebar.style.display === "none" ? "block" : "none";
    }
    function toggleSublist(sublistId) {
      var sublist = document.getElementById(sublistId + 'Sublist');
      sublist.classList.toggle('active'); // Toggle the 'active' class to show/hide the sublist
    }
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>

</body>

</html>
